# ===============================
# Ù…Ø´Ø±ÙˆØ¹ ØªÙˆÙ‚Ø¹ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Student Score Prediction
# ===============================

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
import arabic_reshaper
from bidi.algorithm import get_display

# ğŸ”§ Ø¯Ø§Ù„Ø© Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ
def fix_arabic_text(text):
    reshaped_text = arabic_reshaper.reshape(text)
    return get_display(reshaped_text)

# 1ï¸âƒ£ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
data = pd.read_csv("Hours and Scores.csv", usecols=['Hours', 'Scores'])
print("Ø£ÙˆÙ„ 5 ØµÙÙˆÙ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:")
print(data.head())

# 2ï¸âƒ£ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
print("\nÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:")
print(data.info())

print("\nÙ…Ù„Ø®Øµ Ø¥Ø­ØµØ§Ø¦ÙŠ:")
print(data.describe())

# 3ï¸âƒ£ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©
print("\nØ§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙÙŠ ÙƒÙ„ Ø¹Ù…ÙˆØ¯:")
print(data.isnull().sum())

# 4ï¸âƒ£ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
X = data[['Hours']]
y = data['Scores']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 5ï¸âƒ£ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
model = LinearRegression()
model.fit(X_train, y_train)

# 6ï¸âƒ£ Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
y_pred = model.predict(X_test)
results = pd.DataFrame({'Hours': X_test['Hours'], 'Actual': y_test, 'Predicted': y_pred})
print("\nÙ†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙØ¹Ù„ÙŠØ© ÙˆØ§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:")
print(results)

# 7ï¸âƒ£ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print("\nğŸ“Š ØªÙ‚ÙŠÙŠÙ… Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:")
print("Ù…ØªÙˆØ³Ø· Ø§Ù„Ø®Ø·Ø£ Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ (MSE):", mse)
print("Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ (RÂ²):", r2)

# 10ï¸âƒ£ ØªØ¬Ø±Ø¨Ø© Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ Ù‚Ø¨Ù„ Ø¹Ø±Ø¶ Ø£ÙŠ Ø±Ø³Ù…
hours = float(input("\nØ§Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„ØªÙŠ ØªÙ…Øª Ù…Ø°Ø§ÙƒØ±ØªÙ‡Ø§: "))
# Ø§Ø³ØªØ®Ø¯Ø§Ù… pd.DataFrame Ù‡Ù†Ø§ Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙˆØ¯
predicted_score = model.predict(pd.DataFrame({'Hours': [hours]}))
print(f"Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ù‡ÙŠ: {predicted_score[0]:.2f}")

# 8ï¸âƒ£ Ø±Ø³Ù… Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
plt.figure(figsize=(8,5))
plt.scatter(X, y, color='blue', label=fix_arabic_text('Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©'))
plt.plot(X, model.predict(X), color='red', linewidth=2, label=fix_arabic_text('Ø®Ø· Ø§Ù„ØªÙ†Ø¨Ø¤'))

# âœ… Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø·Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
plt.scatter(hours, predicted_score, color='purple', s=120, marker='*', label=fix_arabic_text('Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯'))

plt.title(fix_arabic_text("Ø®Ø· Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨ÙŠÙ† Ø§Ù„Ø³Ø§Ø¹Ø§Øª ÙˆØ§Ù„Ø¯Ø±Ø¬Ø§Øª"))
plt.xlabel(fix_arabic_text("Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª"))
plt.ylabel(fix_arabic_text("Ø§Ù„Ø¯Ø±Ø¬Ø§Øª"))
plt.legend()
plt.grid(True)
plt.show()